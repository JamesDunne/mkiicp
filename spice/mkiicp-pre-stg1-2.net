* MK IIC+ preamp tube stage 1 and tone stack

** input=N019
** output=N009

* input and tube stage 1:
V1 N019 0 wavefile=di-cut.wav
VE N003 0 405
R4 N003 N004 150k
XV1A N004 N019 N033 12AX7
R1 N019 0 1Meg
R2 N033 0 1.5k
C1 N033 0 .47µ
C2 N033 0 22µ

* tone stack:
R5 N004 N015 100k
C6 N005 N004 750p
C5 N005 N004 250p
C4 N016 N015 .1µ
C3 N024 N015 .047µ
RA_TREBLE N005 N007 {250k*(1-treble)}
RC_TREBLE N007 N016 {250k*(treble)}
RA_BASS N016 N024 {250k*(1-bass)}
RA_MID N024 0 {10k*(1-mid)}

R5A N008 N007 100k
RA_VOLUME1 N020 N008 {1Meg*(1-vol1)}
RC_VOLUME1 N020 0 {1Meg*(vol1)}
C13B N020 N008 180p

R8 N003 N009 100k
C13 N028 0 22µ
R7 N028 0 1.5k
XV1B N009 N020 N028 12AX7

* lead drive:
* input=N009, output=N002
C7 N009 N001 .1µ
R9 N001 0 100k
R10 N001 N002 3.3Meg
C10 N001 N002 20p
C21 N001 N011 .02µ
R21 N011 N024 680k
RA_LEAD_DRIVE N024 N029 {1Meg*(1-gain)}
RC_LEAD_DRIVE N029 0 {1Meg*(gain)}
R22 N029 0 475k
C22 N029 N035 120p
R23 N035 0 1.5k
C23 N035 0 2.2µ
XV3B N017 N029 N035 12AX7

R26 N017 N010 82k
VC N010 0 410

C25 N017 N018 .022µ
R25 N018 N030 270k
R24 N030 0 68k
C24 N030 0 1000p
XV4A N025 N030 N034 12AX7
C29 N034 0 .22µ
R30 N034 0 3.3k

R27 N025 N010 274k
C30 N025 N026 .047µ

R31 N026 N002 220k
C31 N026 N002 250p
C32 N002 0 500p
R32 N002 0 100k
R11 N002 0 680k
C11 N002 0 47p

* remainder of circuit:
**XV2B N021 N002 N036 12AX7
**R16 N036 0 1.5k
**R13 N006 N021 100k
**C9 P001 N021 .047µ
**R105 N022 P001 47k
**R46 N022 0 47k
**R102 N022 N032 150k
**R101 N032 0 4.7k
**XV2A N012 N023 N031 12AX7
**R19 N006 N012 120k
**C12 N013 N012 .047µ
**RC_MASTER 0 0 {1Meg*(master)}
**RA_MASTER N014 0 {1Meg*(1-master)}
**VC2 N006 0 410
**R103 N023 0 47k
**C16 N031 0 .47µ
**C15 N031 0 15µ
**R104 N031 0 1k
**R20 0 0 68k
**R12 N023 N032 2.2k
**R29 0 0 6.8k
**R106 N014 N013 15k
**R6 N005 N005 10Meg
**R3 0 0 15k
**E1 wout 0 N014 0 {1/1400}

.param treble=0.8
.param mid=0.33
.param bass=0.05
.param vol1=0.75

**.param gain=0.5
**.param master=0.5

.tran 0.0000026 10
**.wave mkiic+-out.wav 16 48000 V(wout)

****************************************************
.SUBCKT 12AX7 1 2 3; A G C;
X1 1 2 3 TriodeK MU= 96.20 EX=1.437 KG1= 613.4 KP= 740.3 KVB= 1672. RGI=2000 CCG=0.0P  CGP=0.0P CCP=0.0P ;
.ENDS

.SUBCKT TriodeK 1 2 3; A G C
E1 7 0 VALUE={V(1,3)/KP*LOG(1+EXP(KP*(1/MU+V(2,3)/SQRT(KVB+V(1,3)*V(1,3)))))}
RE1 7 0 1G
G1 1 3 VALUE={0.5*(PWR(V(7),EX)+PWRS(V(7),EX))/KG1}
RCP 1 3 1G    ; TO AVOID FLOATING NODES IN MU-FOLLOWER
C1 2 3 {CCG}  ; CATHODE-GRID
C2 2 1 {CGP}  ; GRID-PLATE
C3 1 3 {CCP}  ; CATHODE-PLATE
D3 5 3 DX     ; FOR GRID CURRENT
R1 2 5 {RGI}  ; FOR GRID CURRENT
.MODEL DX D(IS=1N RS=1 CJO=10PF TT=1N)
.ENDS TriodeK
****************************************************

.backanno
.end
